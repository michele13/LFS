<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY libreoffice-dl "http://download.documentfoundation.org/libreoffice/src/&libreoffice-version;">

  <!ENTITY libreoffice-core-download-http "&libreoffice-dl;/libreoffice-&libreoffice-dlversion;.tar.xz">
  <!ENTITY libreoffice-core-md5sum        "0347f2c919e809b3f3794ed509caa902">
  <!ENTITY libreoffice-core-size          "118 MB">

  <!ENTITY libreoffice-dict-download-http "&libreoffice-dl;/libreoffice-dictionaries-&libreoffice-dlversion;.tar.xz">
  <!ENTITY libreoffice-dict-md5sum        "f031b9ce64498cd14e07454fb3df5401">
  <!ENTITY libreoffice-dict-size          "36 MB">

  <!ENTITY libreoffice-help-download-http "&libreoffice-dl;/libreoffice-help-&libreoffice-dlversion;.tar.xz">
  <!ENTITY libreoffice-help-md5sum        "fa82b4c4510c78fe22a3a56d53fb9752">
  <!ENTITY libreoffice-help-size          "1.8 MB">

  <!ENTITY libreoffice-translations-download-http "&libreoffice-dl;/libreoffice-translations-&libreoffice-dlversion;.tar.xz">
  <!ENTITY libreoffice-translations-md5sum        "81759541de9ce626a02d652399cd1ffe">
  <!ENTITY libreoffice-translations-size          "122 MB">

  <!ENTITY libreoffice-buildsize          "4.0 GB">
  <!ENTITY libreoffice-time               "139 SBU">
]>

<sect1 id="libreoffice" xreflabel="LibreOffice-&libreoffice-version;">
  <?dbhtml filename="libreoffice.html"?>

  <title>LibreOffice-&libreoffice-version;</title>

  <indexterm zone="libreoffice">
    <primary sortas="a-LibreOffice">LibreOffice</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction to LibreOffice</title>

    <para>
      <application>LibreOffice</application> is a full-featured office suite.
      It is largely compatible with <application>Microsoft Office</application>
      and is descended from <application>OpenOffice.org</application>.
    </para>

    <bridgehead renderas="sect3">Package Information</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Core Download: <ulink url="&libreoffice-core-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Core Download MD5 sum: &libreoffice-core-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Core Download size: &libreoffice-core-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimated disk space required: &libreoffice-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimated build time: &libreoffice-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Additional Downloads</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Dictionaries: <ulink url="&libreoffice-dict-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Dictionaries MD5 sum: &libreoffice-dict-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Dictionaries size: &libreoffice-dict-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Recommended patch:
          <ulink url="&patch-root;libreoffice/libreoffice-&libreoffice-dlversion;-icu53-1.patch"/>
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">LibreOffice Dependencies</bridgehead>

    <bridgehead renderas="sect4">Required</bridgehead>
    <para role="required">
      <xref linkend="gperf"/>,
      <xref linkend="perl-archive-zip"/>,
      <xref linkend="unzip"/>,
      <xref linkend="wget"/>, and
      <xref linkend="zip"/>
    </para>

    <bridgehead renderas="sect4">Recommended</bridgehead>
    <note>
      <para>
        Most of these packages are recommended because if they're not installed,
        the build process will compile and install its own (often older)
        version.
      </para>
    </note>

    <para role="recommended">
      <xref linkend="libjpeg"/>,
      <xref linkend="glu"/>,
      <xref linkend="gtk2"/>,
      <xref linkend="boost"/>,
      <xref linkend="cups"/>,
      <xref linkend="curl"/>,
      <xref linkend="expat"/>,
      <xref linkend="graphite2"/>,
      <xref linkend="harfbuzz"/>,
      <xref linkend="gst-plugins-base"/> or
      <xref linkend="gst10-plugins-base"/>,
      <xref linkend="icu"/>,
      <xref linkend="lcms2"/>,
      <xref linkend="librsvg"/>,
      <xref linkend="libwpd"/>,
      <xref linkend="libwpg"/>,
      <xref linkend="libcdr"/>,
      <xref linkend="libmspub"/>,
      <xref linkend="libmwaw"/>,
      <xref linkend="libvisio"/>,
      <xref linkend="libcmis"/>,
      <xref linkend="libexttextcat"/>,
      <xref linkend="hunspell"/>,
      <xref linkend="hyphen"/>,
      <xref linkend="liblangtag"/>,
      <xref linkend="mdds"/>,
      <xref linkend="libodfgen"/>,
      <!-- broken atm <xref linkend="cppunit"/>, -->
      <xref linkend="libwps"/>,
      <xref linkend="mythes"/>,
      <xref linkend="libxml2"/> and
      <xref linkend="libxslt"/>,
      <xref linkend="mesalib"/>,
      <xref linkend="neon"/>,
      <xref linkend="npapi-sdk"/>,
      <xref linkend="nss"/>,
      <xref linkend="vigra"/>,
      <xref linkend="liborcus"/>,
      <xref linkend="clucene"/>,
      <xref linkend="openldap"/> (client only),
      <xref linkend="openssl"/>,
      <xref linkend="lp_solve"/>,
      <xref linkend="poppler"/>,
      <xref linkend="redland"/>, and
      <xref linkend="unixodbc"/>
    </para>

    <bridgehead renderas="sect4">Optional</bridgehead>
    <para role="optional">
      <xref linkend="mariadb"/>,
      <xref linkend="postgresql"/>,
      <xref linkend="mitkrb"/>,
      <xref linkend="sane"/>,
      <xref linkend="vlc"/>,
      <ulink url="http://www.firebirdsql.org/">firebird</ulink>,
      <ulink url="http://www.freedesktop.org/wiki/Software/libabw/">libabw</ulink>,
      <ulink url="http://www.sourceforge.net/projects/libebook/">libebook</ulink>,
      <ulink url="http://www.freedesktop.org/wiki/Software/libfreehand/">libfreehand</ulink>,
      <ulink url="&gnome-download-http;/zenity/">Zenity</ulink>, and
      <xref linkend="libatomic_ops"/>,
    </para>

  </sect2>

  <sect2 role="installation">
    <title>Installation of LibreOffice</title>

    <warning>
      <para>
        Untaring the libreoffice-&libreoffice-dlversion; tarball as
        <systemitem class="username">root</systemitem> has the curious effect of
        changing the ownership of the <emphasis>parent</emphasis> directory
        to a user with numerical id 11012 and with the permissions set to allow
        read, write and execute for that user only! If you untared as
        <systemitem class="username">root</systemitem> in your home folder you
        could end up unable to log in again. If you untared it in
        <filename class="directory">/usr</filename> you would find your user
        account unable to access any file in
        <filename class="directory">/usr</filename>.
      </para>

      <para>
        You can avoid this unpleasantness by
        <emphasis>not</emphasis> untaring it as
        <systemitem class="username">root</systemitem>. If you must untar it as
        <systemitem class="username">root</systemitem> pass the option
        <option>--no-overwrite-dir</option> to tar. This is the default when you
        untar as a user but has to be passed as an option when untaring as
        <systemitem class="username">root</systemitem>:
      </para>
    </warning>

<screen role="root"><userinput>tar -xf libreoffice-&libreoffice-dlversion;.tar.xz --no-overwrite-dir &amp;&amp;
cd libreoffice-&libreoffice-dlversion;</userinput></screen>

    <para>
      Unpack the dictionaries file and create symlink to tarball from the
      source directory so it won't get downloaded again:
    </para>

<screen><userinput>install -dm755 src &amp;&amp;
tar -xf ../libreoffice-dictionaries-&libreoffice-dlversion;.tar.xz --no-overwrite-dir --strip-components=1 &amp;&amp;
ln -sv ../../libreoffice-dictionaries-&libreoffice-dlversion;.tar.xz src/</userinput></screen>

    <note>
      <para>
        During the build process, some packages will be downloaded (including
        the ones listed as recommended and optional dependencies) if they are
        not present on the system. Doing so, build time may be different
        for everyone.
      </para>
    </note>

    <para>
     If you are using a system version of icu greater than 52.1, apply the recommended
     patch:
    </para>

<screen><userinput>patch -p1 -i ../libreoffice-&libreoffice-dlversion;-icu53-1.patch &amp;&amp;</userinput></screen>

    <para>
      Prepare <application>LibreOffice</application> for compilation by running
      the following commands:
    </para>

<screen><userinput>sed -e "/gzip -f/d"   \
    -e "s|.1.gz|.1|g" \
    -i bin/distro-install-desktop-integration &amp;&amp;
sed -e "/distro-install-file-lists/d" -i Makefile.in &amp;&amp;

chmod -v +x bin/unpack-sources &amp;&amp;
sed -e "s/target\.mk/langlist\.mk/"                \
    -e "s/tar -xf/tar -x --strip-components=1 -f/" \
    -e "/tar -x/s/lo_src_dir/start_dir/"           \
    -i bin/unpack-sources &amp;&amp;

./autogen.sh --prefix=/usr \
             --with-vendor="BLFS" \
             --with-alloc=system \
             --with-parallelism=$(getconf _NPROCESSORS_ONLN) \
             --without-java \
             --disable-gconf \
             --disable-odk \
             --disable-postgresql-sdbc \
             --enable-release-build=yes \
             --disable-dbus \
             --with-system-libs \
             --with-system-headers \
             --without-system-sane \
             --without-system-cppunit \
             --without-system-orcus</userinput></screen>

    <para>
      The instructions below will only build the package without running
      any unit tests. If you prefer to run the unit tests, replace
      <command>make build</command> with <command>make</command>.
    </para>

    <para>
      Build the package:
    </para>

<screen><userinput>make build</userinput></screen>

    <para>
      Now, as the <systemitem class="username">root</systemitem> user:
    </para>

<screen role="root"><userinput>make distro-pack-install &amp;&amp;
install -v -m755 -d /usr/share/appdata &amp;&amp;
install -v -m644 sysui/desktop/appstream-appdata/*.xml /usr/share/appdata</userinput></screen>

    <para>
       If the dictionaries have been built, again as
       <systemitem class="username">root</systemitem> user:
    </para>

<screen role="root"><userinput>chown -cR 0:0 dictionaries/ &amp;&amp;
mkdir -pv /usr/lib/libreoffice/share/extensions/dict-en &amp;&amp;
cp -vR dictionaries/en/* /usr/lib/libreoffice/share/extensions/dict-en</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Command Explanations</title>

    <para>
      <command>sed -e ...</command>: First sed prevents compression of the
      manual pages, the second one prevents a script that causes install to
      fail from running and the third one fixes the unpack script.
    </para>

    <para>
      <command>chmod -v +x ...</command>: Fix the unpack script's permissions.
    </para>

    <para>
      <parameter>--with-vendor=BLFS</parameter>: This switch sets BLFS as
      the vendor which is mentioned when you click "About" on the toolbar.
    </para>

    <para>
      <parameter>--with-alloc=system</parameter>: This switch tells
      <application>LibreOffice</application> to use system allocator
      instead of the internal one.
    </para>

    <para>
      <parameter>--with-parallelism=$(getconf _NPROCESSORS_ONLN)</parameter>:
      This switch tells <application>LibreOffice</application> to use all your
      CPUs to compile in parallel and speed up the build.
    </para>

    <para>
      <parameter>--without-java</parameter>: This switch disables
      <application>Java</application> support in
      <application>LibreOffice</application>.
    </para>

    <para>
      <parameter>--disable-gconf</parameter>: This switch disables compiling
      <application>LibreOffice</application> with the deprecated
      <application>GNOME</application> configuration system support.
    </para>

    <para>
      <parameter>--disable-odk</parameter>: This switch disables installing the
      office development kit. Remove if you want to develop a
      <application>LibreOffice</application> based application.
    </para>

    <para>
      <parameter>--disable-postgresql-sdbc</parameter>: This switch disables compiling
      <application>LibreOffice</application> with the ability to connect to a
      <application>PostgreSQL</application> database. Remove it if you would
      like <application>LibreOffice</application> to be able to connect to a
      <application>PostgreSQL</application> database. If you have installed
      <application>PostgreSQL</application> on your system and would like
      <application>LibreOffice</application> to use that rather than compile its
      own copy, use the <option>--with-system-postgresql</option> switch.
    </para>
 
    <para>
      <parameter>--enable-release-build=yes</parameter>: This switch enables a
      Release Build.
      <application>LibreOffice</application> can be built as a Release Build or
      as a Developer Build, because their default installation paths and user
      profile paths are different. Developer Build displays the words "Dev" and
      "Beta" in several places (e.g, menu and splash scren).
    </para>

    <para>
      <parameter>--disable-dbus</parameter>: This switch disables
      <application>D-Bus</application>. It also disables Bluetooth support and
      font install via PackageKit.
    </para>

    <para>
      <parameter>--with-system-libs --with-system-headers</parameter>: These switches
      prevent <application>LibreOffice</application> from trying to download and
      compile its own versions of package dependencies.
    </para>

    <para>
      <option>--disable-cups</option>: Use this switch if you don't need
      printing support.
    </para>

    <para>
      <option>--disable-gstreamer-0-10</option>: Use this switch if you've
      not installed <xref linkend="gst-plugins-base"/>.
    </para>

    <para>
      <option>--enable-gstreamer</option>: Use this switch if you want to
      use <xref linkend="gst10-plugins-base"/> instead of
      <xref linkend="gst-plugins-base"/> for the avmedia module.
    </para>

  </sect2>

  <sect2 role="content">
    <title>Contents</title>

    <segmentedlist>
      <segtitle>Installed Programs</segtitle>
      <segtitle>Installed Libraries</segtitle>
      <segtitle>Installed Directory</segtitle>

      <seglistitem>
        <seg>
          libreoffice, lobase, localc, lodraw, loffice, lofromtemplate,
          loimpress, lomath, loweb, lowriter, soffice and unopkg;
          several programs under
          <userinput>&lt;prefix&gt;</userinput>/lib/libreoffice/program
        </seg>
        <seg>
          several libraries under
          <userinput>&lt;prefix&gt;</userinput>/lib/libreoffice/{ure/lib,program}
        </seg>
        <seg>
          <userinput>&lt;prefix&gt;</userinput>/lib/libreoffice
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Short Descriptions</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="lobase">
        <term><command>lobase</command></term>
        <listitem>
          <para>
            is a database manager.
          </para>
          <indexterm zone="libreoffice lobase">
            <primary sortas="b-lobase">lobase</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="localc">
        <term><command>localc</command></term>
        <listitem>
          <para>
            is a spreadsheet program.
          </para>
          <indexterm zone="libreoffice localc">
            <primary sortas="b-localc">localc</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="lodraw">
        <term><command>lodraw</command></term>
        <listitem>
          <para>
            is a vector graphics editor and diagramming tool.
          </para>
          <indexterm zone="libreoffice lodraw">
            <primary sortas="b-lodraw">lodraw</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="loimpress">
        <term><command>loimpress</command></term>
        <listitem>
          <para>
            can edit and display PowerPoint presentations.
          </para>
          <indexterm zone="libreoffice loimpress">
            <primary sortas="b-loimpress">loimpress</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="lomath">
        <term><command>lomath</command></term>
        <listitem>
          <para>
            is a mathematical formula editor. 
          </para>
          <indexterm zone="libreoffice lomath">
            <primary sortas="b-lomath">lomath</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="lowriter">
        <term><command>lowriter</command></term>
        <listitem>
          <para>
            is a word processor.
          </para>
          <indexterm zone="libreoffice lowriter">
            <primary sortas="b-lowriter">lowriter</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="unopkg">
        <term><command>unopkg</command></term>
        <listitem>
          <para>
            is a tool to manage <application>LibreOffice</application>
            extensions from the command line. 
          </para>
          <indexterm zone="libreoffice unopkg">
            <primary sortas="b-unopkg">unopkg</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
