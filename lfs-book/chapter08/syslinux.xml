<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-bootable-syslinux" role="wrap">
  <?dbhtml filename="syslinux.html"?>

  <sect1info condition="script">
    <productname>syslinux</productname>
    <productnumber>&syslinux-version;</productnumber>
    <address>&syslinux-url;</address>
  </sect1info>

  <title>Using Syslinux to Set Up the Boot Process</title>

  <sect2>
    <title>Introduction</title>

    <warning><para>Configuring Syslinux incorrectly can render your system
    inoperable without an alternate boot device such as a CD-ROM.  This
    section is not required to boot your LFS system.  You may just
    want to modify your current boot loader, e.g. Grub-Legacy, GRUB2, or
    LILO.</para></warning>

    <para>Ensure that an emergency boot disk is ready to <quote>rescue</quote>
    the computer if the computer becomes unusable (un-bootable).</para>

  </sect2>

  <sect2>
    <title>Setting Up the Configuration</title>

    <para>Syslinux works by writing data to the first physical track of the
    hard disk.  This area is not part of any file system.  The programs
    there access Syslinux modules in the boot partition.  The default location
    is /boot. Make sure the boot partition is set as "active".</para>

    <para>The location of the boot partition is a choice of the user that
    affects the configuration.  One recommendation is to have a separate small
    (suggested size is 100 MB) partition just for boot information.  That way
    each build, whether LFS or some commercial distro, can access the same boot
    files and access can be made from any booted system.  If you choose to do
    this, you will need to mount the separate partition, move all files in the
    current <filename class="directory">/boot</filename> directory (e.g. the
    linux kernel you just built in the previous section) to the new partition.
    You will then need to unmount the partition and remount it as <filename
    class="directory">/boot</filename>.  If you do this, be sure to update
    <filename>/etc/fstab</filename>.</para>

    <para>Using the current lfs partition will also work, but configuration
    for multiple systems is more difficult.</para>

    <para>Using the above information, determine the appropriate
    designator for the root partition (or boot partition, if a separate
    one is used). For the following example, it is assumed that the root
    (or separate boot) partition is <filename
    class="partition">sda1</filename>.</para>

    <para>Install the Syslinux files into <filename
    class="directory">/boot</filename> and set up the boot track:</para>

    <warning>
      <para>The following command will overwrite the current boot loader. Do not
      run the command if this is not desired, for example, if using a third party
      boot manager to manage the Master Boot Record (MBR).</para>
    </warning>

<screen role="nodump"><userinput>extlinux --install /boot
cat /lib/syslinux/mbr.bin > /dev/sda</userinput></screen>

  </sect2>

  <sect2>
    <title>Creating the Configuration File</title>

    <para>Generate <filename>/boot/extlinux.conf</filename>:</para>

    <screen><userinput>cat &gt; /boot/extlinux.conf &lt;&lt; "EOF"
<literal>PROMPT 1
TIMEOUT 100
DEFAULT lfs

LABEL lfs
        KERNEL vmlinuz-&linux-version;
        APPEND root=/dev/sda1 ro</literal>
EOF</userinput></screen>

   </sect2>

</sect1>
